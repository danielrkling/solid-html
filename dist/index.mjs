import{ErrorBoundary as e,For as t,Index as n,Match as r,Show as i,Suspense as a,Switch as o,createComponent as s,mergeProps as c}from"solid-js";import{SyntaxKind as l,parse as u}from"html5parser";import{SVGElements as d,insert as f,spread as p}from"solid-js/web";function m(e){return typeof e==`string`}function h(e){return typeof e==`number`}function g(e){return typeof e==`function`}function _(e){return typeof e==`boolean`}function v(e){return typeof e==`object`}const y=Array.from,b=document,x=e=>b.createComment(e);function S(e){return d.has(e)?b.createElementNS(`http://www.w3.org/2000/svg`,e):b.createElement(e)}function C(e){return e.length===1?e[0]:e}function w(e){for(;g(e);)e=e();return e}const T=`⧙⧘`,E=RegExp(`${T}(\\d+)${T}`,`g`);function D(e){let t=u(e.slice(1).reduce((e,t,n)=>e+T+n+T+t,e[0]));return{type:6,children:O(t)}}function O(e){return e.flatMap(k)}function k(e){if(e.type===l.Text){let t=A(e.value);return t.map(e=>{let t=m(e)?1:3;return{type:t,value:e}})}if(e.name[0]===`!`||e.name===``)return{type:2,value:e.body.reduce((e,t)=>e+=t.value,``)};let t=e.attributes.map(e=>{let t=A(e.name.value);if(t.length===1){let n=t[0];if(m(n)){let t=A(e.value?.value);return t.length===0?[n,!0]:t.length===1?[n,t[0]]:[n,t]}else return[`ref`,n]}else return[t[0],t[1]]}),n=e.body?.flatMap(k)??[],r=e.rawName;return{type:/^[A-Z]/.test(r)?5:4,name:r,props:t,children:n}}function A(e=``){return e.split(E).map((e,t)=>t%2==1?Number(e):e).filter(e=>h(e)||e.trim())}function j(e){if(e.type===6||e.type===5){if(e.children.some(e=>e.type===4)){let t=document.createElement(`template`);t.innerHTML=e.children.map(M).join(``),e.template=t}e.children.forEach(j)}e.type===4&&e.children.forEach(j)}function M(e){switch(e.type){case 1:return e.value;case 2:return`<!--${e.value}-->`;case 3:return`<!--+-->`;case 5:return`<!--${e.name}-->`;case 4:let t=``;return e.props=e.props.filter(([e,n])=>{if(m(n)){t+=` ${e}="${n}"`;return}else if(n===!0){t+=` ${e}`;return}return!0}),`<${e.name}${t}>${e.children.map(M).join(``)}</${e.name}>`}}const N=new WeakMap,P=document.createTreeWalker(document,133);function F(e){function t(t,...n){let r=I(t);return R(r,n,e)}return t.components=e,t.sld=t,t.define=function(t){return F({...e,...t})},t}function I(e){let t=N.get(e);return t||(t=D(e),j(t),N.set(e,t)),t}function L(e,t,n){switch(e.type){case 1:return e.value;case 3:return t[e.value];case 2:return x(e.value);case 4:let r=S(e.name);return p(r,z(e,t,n),d.has(e.name),!0),r;case 5:let i=n[e.name];if(!i)throw Error(`${e.name} is not defined`);return s(i,z(e,t,n))}}function R(e,t,n){let r=(e.type===6||e.type===5)&&e.template;if(!r)return C(e.children.map(e=>L(e,t,n)));let i=r.content.cloneNode(!0);P.currentNode=i,a(e.children);function a(e){for(let r of e){let e=P.nextNode();if(r.type===4){if(r.props.length){let i=z(r,t,n);p(e,i,d.has(r.name),!0)}a(r.children)}else (r.type===3||r.type===5)&&(f(e.parentNode,L(r,t,n),e),P.currentNode=e)}}return y(i.childNodes)}function z(e,t,n,r={}){for(let[n,i]of e.props)if(n===`...`){if(h(i)){let e=t[i];if(!v(e))throw Error(`Can only spread objects`);r=c(r,e)}}else{let e=m(i)||_(i)?i:h(i)?t[i]:()=>i.map(e=>h(e)?w(t[e]):e).join(``);g(e)&&e.length===0&&n!==`ref`&&!n.startsWith(`on`)?Object.defineProperty(r,n,{get(){return e()},enumerable:!0}):r[n]=e}return e.children.length&&Object.defineProperty(r,`children`,{get(){return R(e,t,n)}}),r}const B={For:t,Index:n,Match:r,Suspense:a,ErrorBoundary:e,Show:i,Switch:o};function V(e={}){return F({...B,...e})}const H=F(B);var U=H;function W(e){return t=>s(e,t)}export{V as SLD,SLDInstance,F as createSLD,U as default,B as defaultComponents,D as parse,W as run,H as sld};
//# sourceMappingURL=index.mjs.map