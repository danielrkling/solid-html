import{ErrorBoundary as e,For as t,Index as n,Match as r,Show as i,Suspense as a,Switch as o,createComponent as s,mergeProps as c}from"solid-js";import{SVGElements as l,insert as u,spread as d}from"solid-js/web";import{SyntaxKind as f,parse as p}from"html5parser";function m(e){return typeof e==`number`}function h(e){return typeof e==`function`}function g(e){return typeof e==`object`}const _=Array.from,v=document,y=e=>v.createComment(e);function b(e){return l.has(e)?v.createElementNS(`http://www.w3.org/2000/svg`,e):v.createElement(e)}function x(e){return e.length===1?e[0]:e}function S(e){for(;h(e);)e=e();return e}const C=`⧙⧘`,w=RegExp(`${C}(\\d+)${C}`,`g`);function T(e){let t=p(e.slice(1).reduce((e,t,n)=>e+C+n+C+t,e[0]));return{type:6,children:E(t)}}function E(e){return e.flatMap(D)}function D(e){if(e.type===f.Text)return e.value.split(w).flatMap((e,t,n)=>t%2==1?{type:3,value:Number(e)}:!e||n.length===3&&!e.trim()?[]:{type:1,value:e});if(e.name[0]===`!`||e.name===``)return{type:2,value:e.body.join(``)};let t=e.attributes.flatMap(e=>{let t=O(e.name.value);if(t.length===1){let n=t[0];if(e.value===void 0)return{name:n,type:1};if(m(n))return{type:6,value:t[1]};let r=O(e.value?.value);if(r.length===0)return{name:n,type:1};if(r.length===1){let e=r[0];return m(e)?{type:3,name:n,value:e}:{type:2,name:n,value:e}}else return{type:4,name:n,value:r}}return t[0]===`...`?{type:5,value:t[1]}:[]}),n=e.body?.flatMap(D)??[],r=e.rawName;return{type:/^[A-Z]/.test(r)?5:4,name:r,props:t,children:n}}function O(e=``){return e.split(w).map((e,t)=>t%2==1?parseInt(e):e).filter(e=>m(e)||!e)}function k(e){if(e.type===6||e.type===5){if(e.children.some(e=>e.type===4)){let t=document.createElement(`template`);t.innerHTML=e.children.map(A).join(``),e.template=t}e.children.forEach(k)}e.type===4&&e.children.forEach(k)}function A(e){switch(e.type){case 1:return e.value;case 2:return`<!--${e.value}-->`;case 3:return`<!--+-->`;case 5:return`<!--${e.name}-->`;case 4:let t=``;return e.props=e.props.filter(e=>{if(e.type===2){t+=` ${e.name}="${e.value}"`;return}else if(e.type===1){t+=` ${e.name}`;return}return!0}),`<${e.name}${t}>${e.children.map(A).join(``)}</${e.name}>`}}const j=new WeakMap,M=document.createTreeWalker(document,133);function N(e){function t(t,...n){let r=P(t);return I(r,n,e)}return t.components=e,t.sld=t,t.define=function(t){return N({...e,...t})},t}function P(e){let t=j.get(e);return t||(t=T(e),k(t),j.set(e,t)),t}function F(e,t,n){switch(e.type){case 1:return e.value;case 3:return t[e.value];case 2:return y(e.value);case 4:let r=b(e.name);return d(r,L(e,t,n),l.has(e.name),!0),r;case 5:let i=n[e.name];if(!i)throw Error(`${e.name} is not defined`);return s(i,L(e,t,n))}}function I(e,t,n){let r=(e.type===6||e.type===5)&&e.template;if(!r)return x(e.children.map(e=>F(e,t,n)));let i=r.content.cloneNode(!0);M.currentNode=i,a(e.children);function a(e){for(let r of e){let e=M.nextNode();if(r.type===4){if(r.props.length){let i=L(r,t,n);d(e,i,l.has(r.name),!0)}a(r.children)}else (r.type===3||r.type===5)&&(u(e.parentNode,F(r,t,n),e),M.currentNode=e)}}return _(i.childNodes)}function L(e,t,n,r={}){for(let n of e.props)switch(n.type){case 1:r[n.name]=!0;break;case 2:r[n.name]=n.value;break;case 3:R(r,n.name,t[n.value]);break;case 4:let e=()=>n.value.map(e=>m(e)?S(t[e]):e).join(``);R(r,n.name,e);break;case 5:let i=t[n.value];if(!g(i))throw Error(`Can only spread objects`);r=c(r,i);break;case 6:r.ref=t[n.value];break}return e.children.length&&Object.defineProperty(r,`children`,{get(){return I(e,t,n)}}),r}function R(e,t,n){h(n)&&n.length===0&&t!==`ref`&&!t.startsWith(`on`)?Object.defineProperty(e,t,{get(){return n()},enumerable:!0}):e[t]=n}const z={For:t,Index:n,Match:r,Suspense:a,ErrorBoundary:e,Show:i,Switch:o},B=N(z);var V=B;const H=B.define;function U(e){return t=>s(e,t)}export{H as SLD,N as createSLD,V as default,z as defaultComponents,T as parse,U as run,B as sld};
//# sourceMappingURL=index.mjs.map